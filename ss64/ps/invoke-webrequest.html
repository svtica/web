https://apple.stackexchange.com<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/invoke-webrequest.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:00 GMT -->

<head><meta charset="UTF-8">
<meta name="viewport" content="width=768, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Invoke-WebRequest - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html">SS64</a></li>
<li class="tbtn"><a href="index.html">PowerShell <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li class="tbtn"><a href="syntax.html">How-to <svg viewBox="0 0 13 20.1" width="13" height="13" style="transform: rotate(0deg);"><path d="M0 2.9l7.2 7.2-7.1 7.1L3 20.1l7.1-7.1 2.9-2.9L2.9 0 0 2.9"></path></svg></a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Invoke-WebRequest</h1> 
<p>Get content from a web page on the Internet.</p>
<pre>Syntax
      Invoke-WebRequest [-Uri] <i>Uri</i> [-Body <i>Object</i>] [-Certificate <i>X509Certificate</i>] [-CertificateThumbprint <i>String</i>] 
         [-ContentType <i>String</i>] [-Credential <i>PSCredential</i>] [-DisableKeepAlive] [-Headers <i>IDictionary</i>]
            [-InFile <i>String</i>] [-MaximumRedirection <i>Int32</i>]
               [-Method <b>{</b>Default | Get | Head | Post | Put | Delete | Trace | Options | Merge | Patch<b>}</b>]
                  [-OutFile <i>String</i>] [-PassThru] [-Proxy <i>Uri</i>] [-ProxyCredential <i>PSCredential</i>] 
                     [-ProxyUseDefaultCredentials] [-SessionVariable <i>String</i>] [-TimeoutSec <i>Int32</i>]
                        [-TransferEncoding <b>{</b>chunked | compress | deflate | gzip | identity<b>}</b>]
                           [-UseBasicParsing] [-UseDefaultCredentials] [-UserAgent <i>String</i>] 
                              [-WebSession <i>WebRequestSession</i>] [<i><a href="common.html">CommonParameters</a></i>]

Key
   -Body <i>Object</i>
       The body of the request. The body is the content of the request that follows the headers.
       You can also pipe a body value to Invoke-WebRequest.
        
       The Body parameter can be used to specify a list of query parameters or specify the content of the response.
        
       When the input is a GET request and the body is an IDictionary (typically, a hash table), the body is added to 
       the URI as query parameters. For other GET requests, the body is set as the value of the request body in the 
       standard name=value format.
        
       When the body is a form, or it is the output of an Invoke-WebRequest call, Windows PowerShell sets the request 
       content to the form fields.
        
       For example:
        
       `$R = Invoke-WebRequest http://website.com/login.aspx` `$R.Forms[0].Name = "MyName"` `$R.Forms[0].Password = 
       "MyPassword"` `Invoke-RestMethod http://website.com/service.aspx -Body $R`
        
       - or -
        
       `Invoke-RestMethod http://website.com/service.aspx -Body $R.Forms[0]`

   -Certificate <i>X509Certificate</i>
       The client certificate that is used for a secure web request. Enter a variable that contains a certificate
       or a command or expression that gets the certificate.
        
       To find a certificate, use Get-PfxCertificate or use the Get-ChildItem cmdlet in the Certificate (Cert:) 
       drive. If the certificate is not valid or does not have sufficient authority, the command fails.
        
   -CertificateThumbprint <i>String</i>
       The digital public key certificate (X509) of a user account that has permission to send the request. 
       Enter the certificate thumbprint of the certificate.
        
       Certificates are used in client certificate-based authentication. They can be mapped only to local user 
       accounts; they do not work with domain accounts.
        
       To get a certificate thumbprint, use the Get-Item or Get-ChildItem command in the PowerShell Cert: drive.
       
   -ContentType <i>String</i>
       The content type of the web request.
        
       If this parameter is omitted and the request method is POST, Invoke-WebRequest sets the content type to 
       application/x-www-form-urlencoded. Otherwise, the content type is not specified in the call.
        
   -Credential <i>PSCredential</i>
       A user account that has permission to send the request. The default is the current user.
        
       Type a user name, such as User64 or ss64Dom\User64, or enter a PSCredential object, such as one generated by 
       the Get-Credential cmdlet.
        
   -DisableKeepAlive
       Indicates that the cmdlet sets the KeepAlive value in the HTTP header to False. By default, KeepAlive is True. 
       KeepAlive establishes a persistent connection to the server to facilitate subsequent requests.
        
   -Headers <i>IDictionary</i>
       The headers of the web request. Enter a hash table or dictionary.
        
       To set UserAgent headers, use the UserAgent parameter. You cannot use this parameter to specify UserAgent or 
       cookie headers.
        
   -InFile <i>String</i>
       Gets the content of the web request from a file.
        
       Enter a path and file name. If you omit the path, the default is the current location.
        
   -MaximumRedirection <i>Int32</i>
       Specifies how many times Windows PowerShell redirects a connection to an alternate Uniform Resource Identifier 
       (URI) before the connection fails. The default value is 5. A value of 0 (zero) prevents all redirection.
       
   -Method <i>WebRequestMethod</i>
       The method used for the web request. The acceptable values for this parameter are:
        
        - Default
        - Delete
        - Get
        - Head
        - Merge
        - Options
        - Patch
        - Post
        - Put
        - Trace
        
   -OutFile <i>String</i>
       The output file for which this cmdlet saves the response body. Enter a path and file name.
       If you omit the path, the default is the current location.
        
       By default, Invoke-WebRequest returns the results to the pipeline. To send the results to a file and to the 
       pipeline, use the Passthru parameter.
        
   -PassThru
       Indicates that the cmdlet returns the results, in addition to writing them to a file. This parameter is valid 
       only when the OutFile parameter is also used in the command.

   -Proxy <i>Uri</i>
       A proxy server for the request, rather than connecting directly to the Internet resource. Enter the 
       URI of a network proxy server.
        
   -ProxyCredential <i>PSCredential</i>
       A user account that has permission to use the proxy server that is specified by the -Proxy parameter. 
       The default is the current user.
        
       Type a user name, such as "User01" or "Domain01\User01", or enter a PSCredential object, such as one generated 
       by the Get-Credential cmdlet.
        
       This parameter is valid only when the Proxy parameter is also used in the command. You cannot use the 
       ProxyCredential and ProxyUseDefaultCredentials parameters in the same command.
        
   -ProxyUseDefaultCredentials
       Indicates that the cmdlet uses the credentials of the current user to access the proxy server that is 
       specified by the Proxy parameter.
        
       This parameter is valid only when the Proxy parameter is also used in the command. You cannot use the 
       ProxyCredential and ProxyUseDefaultCredentials parameters in the same command.
        
   -SessionVariable <i>String</i>
       Specifies a variable for which this cmdlet creates a web request session and saves it in the value. Enter a 
       variable name without the dollar sign ($) symbol.
        
       When you specify a session variable, Invoke-WebRequest creates a web request session object and assigns it to 
       a variable with the specified name in your Windows PowerShell session. You can use the variable in your 
       session as soon as the command completes.
        
       Unlike a remote session, the web request session is not a persistent connection. It is an object that contains 
       information about the connection and the request, including cookies, credentials, the maximum redirection 
       value, and the user agent string. You can use it to share state and data among web requests.
        
       To use the web request session in subsequent web requests, specify the session variable in the value of the 
       WebSession parameter. Windows PowerShell uses the data in the web request session object when establishing the 
       new connection. To override a value in the web request session, use a cmdlet parameter, such as UserAgent or 
       Credential . Parameter values take precedence over values in the web request session.
       You cannot use the SessionVariable and WebSession parameters in the same command.
      
   -TimeoutSec <i>Int32</i>
       How long the request can be pending before it times out. Enter a value in seconds. The default 
       value, 0, specifies an indefinite time-out.
        
       A Domain Name System (DNS) query can take up to 15 seconds to return or time out. If your request contains a 
       host name that requires resolution, and you set TimeoutSec to a value greater than zero, but less than 15 
       seconds, it can take 15 seconds or more before a WebException is thrown, and your request times out.
        
   -TransferEncoding <i>String</i>
       A value for the transfer-encoding HTTP response header. The acceptable values for this parameter are:
        - Chunked
        - Compress
        - Deflate
        - GZip
        - Identity

   -Uri <i>Uri</i>
       The Uniform Resource Identifier (URI) of the Internet resource to which the web request is sent. 
       Enter a URI. This parameter supports HTTP, HTTPS, FTP, and FILE values.
        
       This parameter is required. The parameter name ( Uri ) is optional.
        
   -UseBasicParsing
       Indicates that the cmdlet uses the response object for HTML content without Document Object Model (DOM) 
       parsing.
        
       This parameter is required when Internet Explorer is not installed on the computers, such as on a Server Core 
       installation of a Windows Server operating system.
        
   -UseDefaultCredentials
       Indicates that the cmdet uses the credentials of the current user to send the web request.
        
   -UserAgent <i>String</i>
       A user agent string for the web request.
        
       The default user agent is similar to Mozilla/5.0 (Windows NT; Windows NT 6.1; en-US) WindowsPowerShell/3.0 
       with slight variations for each operating system and platform.
        
       To test a website with the standard user agent string that is used by most Internet browsers, use the 
       properties of the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.powershell.commands?view=powershellsdk-1.1.0">PSUserAgent</a> class, such as Chrome, FireFox, InternetExplorer, Opera, and Safari.
        
       For example, the following command uses the user agent string for Internet
        
       `Invoke-WebRequest -Uri http://website.com/ -UserAgent 
       ([Microsoft.PowerShell.Commands.PSUserAgent]::InternetExplorer)`
        
   -WebSession <i>WebRequestSession</i>
       A web request session. Enter the variable name, including the dollar sign ($).
        
       To override a value in the web request session, use a cmdlet parameter, such as UserAgent or Credential . 
       Parameter values take precedence over values in the web request session.
        
       Unlike a remote session, the web request session is not a persistent connection. It is an object that contains 
       information about the connection and the request, including cookies, credentials, the maximum redirection 
       value, and the user agent string. You can use it to share state and data among web requests.
        
       To create a web request session, enter a variable name (without a dollar sign) in the value of the 
       SessionVariable parameter of an Invoke-WebRequest command. Invoke-WebRequest creates the session and saves it 
       in the variable. In subsequent commands, use the variable as the value of the WebSession parameter.
        
       You cannot use the SessionVariable and WebSession parameters in the same command.</pre>
<p>The Invoke-WebRequest cmdlet sends HTTP, HTTPS, FTP, and FILE requests to a web page or web service. It parses the      response and returns collections of forms, links, images, and other significant HTML elements.          This cmdlet was introduced in Windows PowerShell 3.0.</p>
<p>To get <a href="https://twitter.com/CPoweredLion/status/1083904275929956354">10x faster</a> download with Invoke-WebRequest, set <span class="code"><a href="syntax-preference.html">$ProgressPreference</a> = 'SilentlyContinue'</span><br>
In PowerShell Core6 this is not needed.</p>
<p><b>Examples</b></p>
<p>Send a web request to Bing.com:</p>
<blockquote>
<p> <span class="code">PS C:\&gt; $Req = Invoke-WebRequest -URI https://www.bing.com?q=how+many+feet+in+a+mile     </span></p>
<p class="code">PS C:\&gt; $Req.AllElements | where {$_.innerhtml -like &quot;<b>*=*</b>&quot;} | Sort { $_.InnerHtml.Length } | Select InnerText -First 5     innerText---------1 =5280 feet1 mile</p>
<p> The first command issues the request and saves the response in the $Req variable. <br>
The second command gets the <span class="code">.InnerHtml</span> property when it includes an equal sign, sorts the inner HTML by length and selects the 5 shortest values. Sorting by the shortest HTML value often helps you find the most specific element that matches that text.</p>
</blockquote>
<p>Get links from a web page:</p>
<blockquote>
<p class="code">PS C:\&gt; (Invoke-WebRequest -Uri &quot;https://ss64.com/nt/&quot;).Links.Href</p>
<p>This command gets the links in a web page. It uses the Invoke-WebRequest cmdlet to get the web page content. Then it users the Links property of the HtmlWebResponseObject that Invoke-WebRequest returns, and the Href property of each link.</p>
</blockquote>
<p>Download the <a href="https://ftp.mozilla.org/pub/firefox/releases/latest/README.txt">latest version</a> of Firefox for Windows (English-US) and perform a silent Install:</p>
<blockquote>
<pre>$TempInstall = "$env:temp\firefox_setup.exe"
$url = 'https://download.mozilla.org/?product=firefox-latest&amp;os=win&amp;lang=<b><a href="https://ftp.mozilla.org/pub/firefox/releases/latest/README.txt">en-US</a></b>'
Invoke-WebRequest -Uri $url -OutFile $TempInstall -UseBasicParsing
Start-Process -FilePath $TempInstall <a href="https://firefox-source-docs.mozilla.org/browser/installer/windows/installer/FullConfig.html">-Args</a> '/DesktopShortcut=false' -Wait
Remove-Item -Path $TempInstall</pre>
</blockquote>
<p>Retrieve a specific command page from <span class="code">ss64.com/ps</span>, and then display the quotation by selecting the class 'quote':</p>
<blockquote>
<pre>function ss64Quotes {
param(
  [string]$command
)
$command = $command.ToLower()
$geturl = Invoke-WebRequest -uri ss64.com/ps/$command.html

$quote = $geturl.AllElements | ? { $_.Class -eq 'quote' } | select innertext

Write-Host $quote.innerText
Get-Help $command
}</pre>
<p>(via <a href="https://www.reddit.com/r/PowerShell/comments/32lhs5/function_to_gethelp_with_the_quote_from_ss64/">Reddit/PowerShell</a>)</p>
</blockquote>
<p class="quote">“I think that I've learned to relax, and trust in and hire very talented people, and trust in their abilities a little more” ~ Mark Romanek</p>
<p><b>Related PowerShell Cmdlets:</b></p>
<p class="space"><a href="invoke-restmethod.html">Invoke-RestMethod</a> - Send an HTTP or HTTPS request to a RESTful web service.<br>
<a href="new-webserviceproxy.html">New-WebServiceProxy</a> - Create a Web service proxy object.</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</p>
<hr>
<div id=bl>&nbsp;</div>
<div id=br>Copyright &copy; 1999-2020 <a href="../index.html">SS64.com</a><br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/invoke-webrequest.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 29 Aug 2020 00:06:00 GMT -->
</html>
